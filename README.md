# Guide Complet de Configuration et S√©curisation d'un VPS sur Rocky Linux 9

> Ce guide approfondi vous guide pas √† pas dans le processus de configuration et de s√©curisation de votre VPS sous Rocky Linux 9. Il couvre tout, depuis la cr√©ation des cl√©s SSH jusqu'√† la cr√©ation d'un compte utilisateur en passant par la suppression d'une authentification par mot de passe. Chaque √©tape est minutieusement d√©taill√©e pour assurer une mise en place efficace et une s√©curit√© optimale de votre environnement de test ou de production. üöÄüíºüîßüåêüîí

---

## üìã Pr√©-requis

Avant de commencer, v√©rifiez que vous disposez de :

1. **Un VPS avec Rocky Linux 9 d√©j√† install√©**.
2. **Acc√®s root ou avec des privil√®ges sudo**.
3. **Connaissances de base en ligne de commande Linux**.
5. **Un client SSH sur votre machine locale**

    - Par exemple, PuTTY pour Windows ou le terminal int√©gr√© dans Linux et macOS.
    - Sur VS Code, utilisez ces extensions utiles disponibles sur le [marketplace officiel](https://marketplace.visualstudio.com/vscode) :
        - [Remote Development](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.vscode-remote-extensionpack)
        - [Remote - SSH](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-ssh)
        - [Remote Exporer](https://marketplace.visualstudio.com/items?itemName=ms-vscode.remote-explorer)
        - [Remote - SSH:Editing Configuration Files](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-ssh-edit)
        - [Remote - Tunnels](https://marketplace.visualstudio.com/items?itemName=ms-vscode.remote-server)
        - [Remote Repositories](https://marketplace.visualstudio.com/items?itemName=ms-vscode.remote-repositories)

Avec ces pr√©-requis en place, vous √™tes pr√™t √† commencer la configuration de votre VPS. Suivez ce guide, √©tape par √©tape pour une mise en place r√©ussie et s√©curis√©e de votre environnement. üöÄüíºüîß

---

> **Pour s√©curiser le contenu qui sera le mien, je vais utiliser un pseudo et une ip random.**

-   **Pseudo utilis√© prochainement** : `guidevps` (_en minuscule_)
-   **IP utilis√©e** : `50.60.70.80` (_Avec mes tests cette ip n'est pas utilis√©_)

üî¥ **NOTE IMPORTANTE** üî¥
**Il va de soit qu'il vous faudra utiliser vos identifiants qui vous auront √©t√© transmis par mail. (par d√©faut sur OVH, `rocky` sera le nom d'utilisateur lambda)**

---

## 1 - Configuration Initiale de son VPS

1. **üåê Connexion SSH Initiale**

    1. **üîÑ Mettre √† jour son VPS** - (_√† effectuer r√©guli√®rement_)
    2. **üì¶ Paquets √† installer sur Rocky Linux 9**
        - nano (_√©diteur en ligne de commande_)
    3. **üë§ Cr√©ation d'un Nouvel Utilisateur**
    4. **üîë Cr√©ation et Configuration des Cl√©s SSH**
    5. **üîó Copie de la Cl√© Publique sur le Serveur**
    6. **üîß Installation Manuelle de la Cl√© (_si n√©cessaire_)**
    7. **üö™ Modifier le port d'√©coute SSH par d√©faut**
    8. **üîê D√©sactivation de l'Authentification par Mot de Passe**
    2. **Installation de NGINX Ampify**

### 1.1 - üåê Connexion SSH Initiale

‚úÖ _unique rappel sur le faite que nous utiliserons uniquement un pseudo et une ip fictive tout au long de ce guide et qu'il devra √™tre remplacer par le votre_ (**guidevps**).
_Veillez √† remplacer ces identifiants de connexion par les v√¥tres_.

```sh
# Connexion au VPS via SSH (Toute premi√®re fois)
ssh rocky@50.60.70.80
```

-   Le nom d'utilisateur est toujours le compte fourni par votre prestataire. (ex: `rocky` pour un serveur VPS chez OVH).
-   Remplacez `50.60.70.80` par l'adresse IP de votre VPS, qui vous aura √©t√© communiqu√©e par email.

### 1.2 - Mettre √† jour son VPS

üî• Mettre √† jour r√©guli√®rement votre syst√®me est crucial pour la s√©curit√© du VPS.
En effet, les d√©veloppeurs de distributions et de syst√®mes d‚Äôexploitation proposent de fr√©quentes mises √† jour de paquets, tr√®s souvent pour des raisons de s√©curit√©.

```bash
# Mise √† jour de la liste des paquets, mise √† niveaux des paquets eux-m√™mes et suppressions des paquets inutiles
sudo dnf update -y && sudo dnf upgrade -y && sudo dnf autoremove -y
```

> **DNF** est le gestionnaire de paquets pour rocky linux 9

### 1.3 - Installer des paquets facultatif mais utile

Je vous propose ici d'installer quelques paquets absents de la distribution `Rocky Linux 9`.

```sh
# Nano - Editeur en ligne de commande permettant de remplacer vim qui n'est pas simple √† prendre en main pour un non initi√©.
sudo dnf install nano -y
```

_D'autres viendront si le besoin s'en fait ressentir_

### 1.4 - üë§ Cr√©ation d'un Nouvel Utilisateur

#### Pourquoi, j'ai d√©j√† acc√®s au compte rocky ?

Dans la gestion des serveurs et la pratique de la cybers√©curit√©, il est g√©n√©ralement recommand√© de cr√©er et d'utiliser un nouvel utilisateur avec des droits sudo pour l'administration du syst√®me, plut√¥t que d'utiliser directement l'utilisateur par d√©faut (comme `rocky` dans le cas de Rocky Linux) ou, l'utilisateur `root` qui correspond au super administrateur. Voici pourquoi :

1. **S√©curit√© Am√©lior√©e :** L'utilisation d'un utilisateur sp√©cifique pour les t√¢ches d'administration r√©duit les risques associ√©s √† l'utilisation du compte `root` en permanence. Les comptes `root` ou les comptes par d√©faut sont souvent cibl√©s par des attaques automatis√©es.

2. **Suivi des Activit√©s :** Avoir des utilisateurs distincts pour diff√©rentes personnes ou diff√©rents r√¥les facilite le suivi et l'audit des activit√©s sur le serveur.

3. **R√©duction des Erreurs :** Travailler en tant qu'utilisateur non-root oblige √† une r√©flexion suppl√©mentaire avant d'ex√©cuter des commandes potentiellement dangereuses, ce qui peut aider √† pr√©venir des erreurs accidentelles.

4. **Conformit√© aux Bonnes Pratiques :** C'est une bonne pratique en mati√®re de gestion de serveur et de s√©curit√© informatique de ne pas utiliser les comptes root ou par d√©faut pour les op√©rations quotidiennes.

**Pour ces raisons, il est conseill√© de se connecter et de g√©rer votre serveur en utilisant le nom d'utilisateur que vous avez cr√©√©, qui dispose des droits sudo. Cela vous offre un √©quilibre entre la puissance n√©cessaire pour administrer le syst√®me et les contr√¥les de s√©curit√© appropri√©s.**

#### Ok, super mais comment faire ?

```sh
# Dans un premier temps, il est possible de lister les utilisateurs sous linux
cat /etc/passwd

# Nous pouvons voir √† quel groupe appartient le compte rocky fourni par d√©faut
groups rocky
# Affichera:
rocky : rocky adm systemd-journal

# Nous pouvons voir l'identifiant de l'utilisateur
id rocky
uid=1000(rocky) gid=1000(rocky) groups=1000(rocky),4(adm),190(systemd-journal)
```

Pour ajouter un utilisateur, (pour nous, il s'agit ici de guidevps) saisisez:

```sh
sudo adduser guidevps
```

Pour ajouter des droits sudo √† notre utilisateur:

```sh
sudo usermod -aG adm guidevps
sudo usermod -aG systemd-journal totovps

# A utiliser avec prudence, permet de donner le droit d'utiliser "su"
sudo usermod -aG wheel guidevps

# Si vous souhaitez retirer un groupe, exemple adm
sudo usermod -G guidevps,adm guidevps

# Contr√¥ler les changements en r√©utilisant de nouveau de la commande "id user"
id guidevps
# Affichera:
uid=1001(guidevps) gid=1001(rocky) groups=1001(guidevps),190(systemd-journal)

# Si vous souhaitez en revanche retirer tous les groupes que vous avez rejoints,
# il faudra saisir
sudo usermod -G guidevps guidevps

# Pour de nouveau contr√¥ler les changements effectu√©s, on saisiera de nouveau "id user"
id guidevps
# Affichera:
uid=1001(guidevps) gid=1001(rocky) groups=1001(guidevps)
```

Il est possible de cr√©er un mot de passe por notre utilisateur

```sh
sudo passwd guidevps
# Apr√®s avoir ex√©cut√© cette commande, vous serez invit√© √† entrer et confirmer le nouveau mot de passe.
# ‚ö†Ô∏è Sur linux les caract√®res ne s'affiche pas lors de la saisie d'un mot de passe ‚ö†Ô∏è
```

V√©rification du compte (Teste de la connexion avec un acc√®s en **root** notre nouvel utilisateur "guidevps")

```sh
sudo su - guidevps
# Il faudra saisir le mot de passe fraichement cr√©√©.
# remarquez le nom d'utilisateur dans le terminal qui va changer en passant de rocky@xxxxxx √† guidevps@xxxxxxx

# V√©rification acc√®s root
sudo whoami
# Si la commande retourne root, cela signifie que cet utilisateur a bien des droits de superadministrateur.
```

### 1.5 - üîë Cr√©ation et Configuration des Cl√©s SSH

```sh
# G√©n√©rez une paire de cl√©s SSH sur votre machine locale
ssh-keygen -t ed25519 -C "description_de_la_cle"

# remplacer "description_de_la_cle" par ce que vous voulez
```

Voir le contenu de cette cl√© (_besoin un peu plus tard_)

```sh
cat cat C:/Users/votre_user_windows/.ssh/id_ed25519.pub

# Ce qui affichera quelque chose du genre :
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIAC+16EGsoJR0t3A1wGhZ0uYur7JkE3jNxiRtl5uCexS description_de_la_cle
```

‚úÖ - En tant que cl√© publique elle peut √™tre divulgu√© sans risque, **ce qui est important c'est de ne jamais divulguer la cl√© priv√©. Elle se trouve au m√™me endroit d√©pouvue du .pub**.

### 1.6 - Copie de la Cl√© Publique sur notre VPS (server)

> ‚ö†Ô∏è **ATTENTION** - Assurez-vous de copier uniquement le contenu de la cl√© **id_ed25519.pub**

```sh
# Copie de la cl√© publique sur le serveur VPS
ssh-copy-id -i ./id_ed25519.pub guidevps@50.60.70.80
# Le mot de passe du compte sera potentiellement demand√©.
```

### 1.7 - Installation Manuelle de la Cl√© (Si N√©cessaire)

Sur Windows, si `ssh-copy-id` n'est pas disponible, suivez ces √©tapes :

```sh
# Connexion au serveur VPS via SSH
ssh guidevps@50.60.70.80

# Acc√©der au dossier .ssh de l'utilisateur (r√©pertoire cach√©)
cd .ssh

# Afficher le contenue du r√©pertoire cach√© ".ssh"
ls -lah

# √âditer le fichier authorized_keys pour ajouter la cl√© publique (nano sur windows)
sudo nano authorized_keys

# Copier manuellement la cl√© publique g√©n√©r√©e √† l'√©tape 1.5 (id_ed25519.pub)
# Enregistrer avec "CTRL + S" et quitter avec "CTRL + X"

# Afficher le contenu de authorized_keys pour v√©rifier
cat authorized_keys
```

‚úÖ - Si vous disposez de plusieurs ordinateurs et que vous souhaitez accedez en ssh sur votre serveur, chaque cl√© devra √™tre ajouter √† la suite de la premi√®re.

### 1.7 - üö™ Modification du Port d'√âcoute SSH par D√©faut

Vis √† vis de la cybers√©curit√©, changer le port SSH par d√©faut (**22**) au profit d'un port diff√©rent r√©duit le risque d'attaques automatis√©es. (_tentatives de hack du serveur par des robots_).
Utilisez un port non-standard, de pr√©f√©rence entre **49152** et **65535**.

> La modification de ce param√®tre, est une mesure simple pour renforcer la protection de votre serveur contre les attaques automatis√©es. Pour cela, modifiez le fichier de configuration du service avec l'√©diteur de texte de votre choix (_**nano** est utilis√© dans le terminal dans cet exemple_) :

**Je prendrais l'exemple du port 50001 pour oute la dur√©e de ce guide.** :

```sh
# Passer en superadministrateur (root)
sudo su

# Edition du fichier sshd_config se trouvant dans le r√©pertoire /etc/ssh/
cd /etc/ssh

# Voir le contenu du r√©pertoire ssh
ls ssh

# Edition du fichier de configuration avec nano
nano sshd_config
```

Vous devriez trouver les lignes suivantes ou √©quivalentes :

```sh
# ... d'autres lignes de code

#Port 22
#AddressFamily any
#ListenAddress 0.0.0.0
#ListenAddress ::

# ... encore d'autres lignes de code
```

D√©commentez en retirant le **#** et remplacez par :

```sh
# ... d'autres lignes de code

Port 50001
#AddressFamily any
#ListenAddress 0.0.0.0
#ListenAddress ::

# ... encore d'autres lignes de code
```

Donc ici, nous avons d√©comment√© et remplac√© le nombre `22` par le num√©ro de port de suivant `50001`. En effet le port `22` √©tait comment√© mais surtout il est le port par d√©faut.

> Enregistrez (`CTRL + S`) et quittez (`CTRL + X`). Puis red√©marrer le service SSH pour appliquer les changements :

```sh
# sudo n'est pas recquis car nous nommes toujours connect√© en root (super administrateur)
systemctl restart sshd

# Cela devrait √™tre suffisant pour appliquer les changements.
# Dans le cas contraire, red√©marrez le VPS avec cette commande :
reboot
```

‚ö†Ô∏è **ATENTION** - Pour se connecter apr√®s ce changement :

```bash
# Connexion au VPS via SSH avec le nouveau port
ssh guidevps@50.60.70.80 -p 50001
# Saisissez votre mot de passe
```

_Vous devrez indiquer le nouveau port √† chaque demande de connexion SSH √† votre serveur._

### 1.8 - üîê D√©sactivation de l'Authentification par Mot de Passe

Pour plus de s√©curit√©, d√©sactivez l'authentification par mot de passe.
Pour cel√†, nous devons √† nouveau modifier le fichier que l'on a modifi√© pr√©c√©demment.

> ‚ö†Ô∏è **ATTENTION** - Assurez-vous d'avoir copier votre cl√© ssh. Auquel cas la connexion sera impossible.

```sh
# D√©placement dans le r√©pertoire correspondant:
cd /etc/ssh

# Ouvrir le fichier de configuration SSH pour modification (tojours avec nano)
sudo nano sshd_config
```

Modifiez :

```sh
PasswordAuthentication yes # disponible sous rocky linux 9
PermitRootLogin yes # non disponible sous rocky linux 9 (mais on peut l'ajouter)
```

en :

```bash
PasswordAuthentication no
```

Enregistrez (`CTRL + S`) et quittez (`CTRL + X`), puis red√©marrez SSH.

---

## 2 - Installation et Configuration de NGINX

### 2.1 - Avant l'installation

Pour installer la derni√®re version LTS (Long Term Support) de NGINX sur Rocky Linux 9, tu devras suivre quelques √©tapes. Voici les √©tapes √† suivre :

#### 2.1.1 - Ajout du d√©p√¥t NGINX

Tout d'abord, tu dois ajouter le d√©p√¥t officiel de NGINX √† ton syst√®me pour t'assurer d'obtenir la derni√®re version. NGINX ne fournit pas directement un d√©p√¥t pour Rocky Linux, mais tu peux utiliser le d√©p√¥t pour RHEL (**Red Hat Enterprise Linux**) qui est compatible.

```sh
# Cr√©er le fichier de d√©p√¥t NGINX
sudo nano /etc/yum.repos.d/nginx.repo

# Ajouter les informations de d√©p√¥t suivantes dans le fichier :

[nginx-stable]
name=nginx stable repo
baseurl=http://nginx.org/packages/rhel/9/$basearch/
gpgcheck=1
enabled=1
gpgkey=https://nginx.org/keys/nginx_signing.key
module_hotfixes=true
```

Sauvegarde le fichier (`Ctrl + s` et ferme l'√©diteur `Ctrl+X`).

### 2. Installation de NGINX

Apr√®s avoir ajout√© le d√©p√¥t, tu peux installer NGINX :

```sh

# Mettre √† jour les paquets et installer NGINX
sudo dnf update -y && sudo dnf upgrade -y && sudo dnf autoremove -y

# Installation du r√©f√©rentiel de logiciels et nginx
sudo dnf install epel-release
sudo dnf install nginx -y
```

Cette commande va installer la derni√®re version de NGINX disponible dans le d√©p√¥t que tu viens d'ajouter.

### 3. D√©marrage et Activation de NGINX

Une fois NGINX install√©, tu dois le d√©marrer et l'activer pour qu'il se lance au d√©marrage du syst√®me :

```sh
# Plusieurs d√©marrage possible (veillez choisir un choix parmis les 3 commandes ci-dessous)
sudo systemctl start nginx
sudo service nginx start
sudo nginx

# Activer nginx pour relancer nginx au d√©marage
sudo systemctl enable nginx
```

### 4. V√©rification

Pour v√©rifier que NGINX fonctionne correctement :

```bash
sudo systemctl status nginx
```

Et tu peux aussi v√©rifier la version de NGINX install√©e :

```bash
nginx -v

# Tester votre site directement via une ligne de commande
curl -I http://votre_ip

# Affichera quelque chose de similaire
HTTP/1.1 200 OK
Server: nginx/1.20.1
Date: Wed, 17 Jan 2024 23:09:07 GMT
Content-Type: text/html
Content-Length: 7620
Last-Modified: Thu, 02 Feb 2023 21:29:03 GMT
Connection: keep-alive
ETag: "63dc2b1f-1dc4"
Accept-Ranges: bytes
```

### Conclusion

En suivant ces √©tapes, tu auras install√© la derni√®re version LTS de NGINX sur Rocky Linux 9. N'oublie pas de configurer ton pare-feu pour autoriser le trafic HTTP et HTTPS si n√©cessaire.

### üìÑ 2.2 Configuration de NGINX pour Plusieurs Sites

Afin de faciliter l'√©dition des r√©pertoires, veuillez modifier le groupe de quelques r√©pertoires et ajouter le droit d'√©criture pour le compte utilis√© (`guidevps`)

```sh
# voir les droits associ√©s aux fichiers
ls -lah /etc/nginx
# On constatera que nous n'avons pas les droits d'√©criture, que le groupe et propri√©taire est root

# D√©placement dans le r√©pertoire nginx situ√© dans /etc/nginx
cd /etc/nginx

# Il est probable que des r√©pertoires sont absents √† l'initialisation d'nginx
# Cr√©ation de deux r√©pertoires qui seront utilis√©s
sudo mkdir sites-available sites-enabled

# voici la liste des fichiers et r√©pertoires qui doivent √™tre modifi√©s dans le r√©pertoire nginx
# Fichier(s)
sudo chown -R $USER:$USER nginx.conf
# R√©pertoires(s)
sudo chown -R $USER:$USER conf.d/
sudo chown -R $USER:$USER sites-available/
sudo chown -R $USER:$USER sites-available/
# Ou
sudo chown -R $USER:$USER sites-*

# Contr√¥le de l'existance du r√©pertoire "www"
ls -lah /var | grep www

# Si une ligne est retourn√©e c'est que le r√©pertoire existe.
drwxr-xr-x.  3 root root   28 Jan 17 22:38 www

# auquel cas, il faut cr√©er celui-ci
sudo mkdir /var/www

# On va lui attribuer les m√™mes droits que pr√©c√©demment afin de pouvoir ais√©ment intervenir dessus.
cd /var
sudo chmod -R g+w www/
sudo chown -R $USER:$USER www/

# On obtiendra ainsi
drwxrwxr-x.  3 guidevps guidevps   28 Jan 17 22:45 www
```

### üìÑ 2.3 Configuration de NGINX pour Plusieurs Sites

**NOTE:** - R√©p√©tez ces √©tapes pour chacun des sites que vous concevrez :

---

**`scp -r client-build/* guidevps@50.60.70.80:/var/www/site1.fr/html/`**
**`sudo chcon -Rt httpd_sys_content_t /var/www`**

---

```sh
# Cr√©er un r√©pertoire pour le site et configurer les permissions
sudo mkdir -p /var/www/nom_site1.com/html
sudo chown -R $USER:$USER /var/www/site1.com/html

# Cr√©er et √©diter la configuration du site dans NGINX
sudo nano /etc/nginx/sites-available/site1.com

# Activer le site en cr√©ant un lien symbolique
sudo ln -s /etc/nginx/sites-available/site1.com /etc/nginx/sites-enabled/

# Tester et red√©marrer NGINX pour appliquer les changements
sudo nginx -t
sudo systemctl restart nginx
```

---

## 3 - Utilisation de let's Encrypt pour passez en HTTPS

```sh
# On passe en superadministrateur (root)
sudo su

# Installation de certbot
dnf install certbot python3-certbot-nginx -y

# Utilisation de certbot avec nginx ou quelques questions seront pos√©s
certbot --nginx

# Une fois termin√©, on peu voir le contenu de la connexion avec TLS
openssl s_client -connect site1.fr:443
```

Ici je vous propose un lien pour tester votre server que vous aurez configurez.
Pas mal de tests sur des potentiels failles connu sont test√©s.
[https://www.ssllabs.com](https://www.ssllabs.com/index.html)
Et ci dessous un lien pour connaitre la meilleur configuration possible pour son serveur nginx.
[https://ssl-config.mozilla.org/#server=nginx&version=1.24&config=modern&openssl=1.1.1k&guideline=5.7](https://ssl-config.mozilla.org/#server=nginx&version=1.24&config=modern&openssl=1.1.1k&guideline=5.7)

## 3 - Installation de Docker sur le VPS

```bash
# Installer Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh ./get-docker.sh --dry-run

# V√©rification de l'installation
docker -v
```

[Source officiel](https://docs.docker.com/engine/install/ubuntu/#install-using-the-convenience-script)

### üê≥ 3.1 Commandes Docker

#### 3.1.1 Windows

```bash
# T√©l√©charger une image nginx
docker pull nginx

# Lancer un conteneur avec l'image nginx
docker run --name docker-nginx -p 80:80 nginx

# V√©rifier que NGINX fonctionne
sudo ps -ef | grep nginx

# Afficher toutes les VM lanc√©s
docker ps

# Afficher les conteneurs actifsAjout du fichier changelog
docker container ls

# Afficher les images disponibles
docker images ls

# Stoper un container (ici docker-nginx d√©fini plus haut)
docker stop docker-nginx

# Supprimer un container
docker rm docker-nginx
```

**Visitez `localhost` dans votre navigateur pour voir NGINX en action.**

### 3.2 Lancer le Service NGINX

Uniquement si le serveur n'est pas d√©marr√©.

```bash
# D√©marrer le service NGINX
sudo service nginx start
```

---

## üî• 4 - S√©curisation et Pare-feu

### 4.1 Configuration du Pare-feu UFW

```bash
# Installer et configurer UFW (Uncomplicated Firewall)
sudo apt install ufw

# Autoriser le trafic SSH sur les nouveaux ports
sudo ufw allow 50001/tcp # Pour le premier VPS
sudo ufw allow 50002/tcp # Pour le second VPS (si il y en a un)

# Autoriser le trafic pour NGINX
sudo ufw allow 'Nginx Full'

# Activer UFW
sudo ufw enable

# V√©rifier le statut du pare-feu
sudo ufw status
```

---

## 5 - Nginx Amplify

### 5.1 - Installation de NGINX Amplify üîß

NGINX Amplify est un outil performant offrant des m√©triques d√©taill√©es pour surveiller l'√©tat de votre serveur NGINX.

Pour l'installer :

1. **Cr√©ez un compte sur NGINX Amplify** üìù: Rendez-vous sur [le site de NGINX Amplify](https://www.nginx.com/products/nginx-amplify/) pour vous inscrire.
2. **T√©l√©chargez et installez l'agent NGINX Amplify**

Connectez-vous en SSH √† votre serveur et suivez ces √©tapes :

-   Connectez-vous en tant que root üë§:

```bash
# Au cas o√π, voici la commande pour se connecter en root
sudo su
```

-   T√©l√©chargez üì• le script d'installation.
-   Ex√©cutez la commande d'installation en tant que root üë®‚Äçüíª.
-   Suivez les instructions √† l'√©cran et cliquez sur `Continue` ‚úÖ.

Pour v√©rifier et g√©rer l'agent NGINX Amplify :

```bash
# V√©rifier si l'agent NGINX Amplify est install√© et actif üîç
sudo service amplify-agent status

# D√©marrer l'agent NGINX Amplify, si n√©cessaire üü¢
sudo service amplify-agent start

# Arr√™ter l'agent NGINX Amplify üî¥
sudo service amplify-agent stop
```

### 5.2 - Configuration Nginx pour visualiser les m√©triques üìä

Pour configurer NGINX afin de visualiser les m√©triques avec NGINX Amplify, suivez ces √©tapes : (_Header violet_)

Il faut simplement suivre chacune des √©tapes affich√© √† l'√©cran

1. Acc√©dez au r√©pertoire de configuration de NGINX üìÅ:
    ```bash
    cd /etc/nginx
    ```
2. V√©rifiez que les fichiers de configuration additionnels sont inclus üîç:
    ```bash
    grep -i include\.*conf nginx.conf
    ```
3. Cr√©ez une nouvelle configuration pour `stub_status` üìù:
    ```bash
    cat > conf.d/stub_status.conf
    ```
    Puis, copiez et collez le contenu suivant üìã:
    ```nginx
    server {
        listen 127.0.0.1:80;
        server_name 127.0.0.1;
        location /nginx_status {
            stub_status on;
            allow 127.0.0.1;
            deny all;
        }
    }
    ```
4. V√©rifiez et affichez le contenu du fichier de configuration üñ•Ô∏è:
    ```bash
    ls -la conf.d/stub_status.conf && cat conf.d/stub_status.conf
    ```
5. Rechargez la configuration NGINX üîÅ:
    ```bash
    kill -HUP `cat /var/run/nginx.pid`
    ```
